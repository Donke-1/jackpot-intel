{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/NEO/jackpot-intel-app/components/ui/StatusCard.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { Clock, AlertTriangle, CheckCircle2 } from 'lucide-react';\r\nimport { cn } from '@/lib/utils';\r\n\r\ninterface StatusCardProps {\r\n  deadline: string;\r\n  status: string;\r\n}\r\n\r\nexport default function StatusCard({ deadline, status }: StatusCardProps) {\r\n  const [timeLeft, setTimeLeft] = useState('');\r\n  const [isLocked, setIsLocked] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const updateTimer = () => {\r\n      const now = new Date().getTime();\r\n      const target = new Date(deadline).getTime();\r\n      const distance = target - now;\r\n\r\n      if (distance < 0) {\r\n        setIsLocked(true);\r\n        setTimeLeft(\"LOCKED / IN PROGRESS\");\r\n      } else {\r\n        const days = Math.floor(distance / (1000 * 60 * 60 * 24));\r\n        const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\r\n        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));\r\n        setTimeLeft(`${days}d ${hours}h ${minutes}m`);\r\n      }\r\n    };\r\n\r\n    updateTimer(); // Run immediately\r\n    const timer = setInterval(updateTimer, 60000); // Update every minute\r\n\r\n    return () => clearInterval(timer);\r\n  }, [deadline]);\r\n\r\n  return (\r\n    <div className=\"bg-gray-900/50 border border-gray-800 rounded-xl p-4 flex items-center justify-between\">\r\n      <div className=\"flex items-center space-x-4\">\r\n        <div className={cn(\"p-3 rounded-full\", isLocked ? \"bg-red-900/20\" : \"bg-cyan-900/20\")}>\r\n          {isLocked ? <AlertTriangle className=\"text-red-500\" /> : <Clock className=\"text-cyan-500\" />}\r\n        </div>\r\n        <div>\r\n          <h4 className=\"text-sm text-gray-400 font-medium uppercase tracking-wider\">Time Remaining</h4>\r\n          <p className={cn(\"text-xl font-bold font-mono\", isLocked ? \"text-red-500\" : \"text-white\")}>\r\n            {timeLeft || \"CALCULATING...\"}\r\n          </p>\r\n        </div>\r\n      </div>\r\n      \r\n      {status === 'success' && (\r\n        <div className=\"hidden md:flex items-center space-x-2 text-green-500 bg-green-900/10 px-4 py-2 rounded-lg border border-green-900/50\">\r\n          <CheckCircle2 className=\"w-5 h-5\" />\r\n          <span className=\"font-bold\">GOAL HIT</span>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AACA;;;AAJA;;;;AAWe,SAAS,WAAW,EAAE,QAAQ,EAAE,MAAM,EAAmB;;IACtE,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IACzC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IAEzC,IAAA,0KAAS;gCAAC;YACR,MAAM;oDAAc;oBAClB,MAAM,MAAM,IAAI,OAAO,OAAO;oBAC9B,MAAM,SAAS,IAAI,KAAK,UAAU,OAAO;oBACzC,MAAM,WAAW,SAAS;oBAE1B,IAAI,WAAW,GAAG;wBAChB,YAAY;wBACZ,YAAY;oBACd,OAAO;wBACL,MAAM,OAAO,KAAK,KAAK,CAAC,WAAW,CAAC,OAAO,KAAK,KAAK,EAAE;wBACvD,MAAM,QAAQ,KAAK,KAAK,CAAC,AAAC,WAAW,CAAC,OAAO,KAAK,KAAK,EAAE,IAAK,CAAC,OAAO,KAAK,EAAE;wBAC7E,MAAM,UAAU,KAAK,KAAK,CAAC,AAAC,WAAW,CAAC,OAAO,KAAK,EAAE,IAAK,CAAC,OAAO,EAAE;wBACrE,YAAY,GAAG,KAAK,EAAE,EAAE,MAAM,EAAE,EAAE,QAAQ,CAAC,CAAC;oBAC9C;gBACF;;YAEA,eAAe,kBAAkB;YACjC,MAAM,QAAQ,YAAY,aAAa,QAAQ,sBAAsB;YAErE;wCAAO,IAAM,cAAc;;QAC7B;+BAAG;QAAC;KAAS;IAEb,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAW,IAAA,qHAAE,EAAC,oBAAoB,WAAW,kBAAkB;kCACjE,yBAAW,6LAAC,4OAAa;4BAAC,WAAU;;;;;iDAAoB,6LAAC,gNAAK;4BAAC,WAAU;;;;;;;;;;;kCAE5E,6LAAC;;0CACC,6LAAC;gCAAG,WAAU;0CAA6D;;;;;;0CAC3E,6LAAC;gCAAE,WAAW,IAAA,qHAAE,EAAC,+BAA+B,WAAW,iBAAiB;0CACzE,YAAY;;;;;;;;;;;;;;;;;;YAKlB,WAAW,2BACV,6LAAC;gBAAI,WAAU;;kCACb,6LAAC,wOAAY;wBAAC,WAAU;;;;;;kCACxB,6LAAC;wBAAK,WAAU;kCAAY;;;;;;;;;;;;;;;;;;AAKtC;GAjDwB;KAAA"}},
    {"offset": {"line": 149, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/NEO/jackpot-intel-app/components/ui/PredictionTable.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport { Prediction } from '@/types';\r\nimport { cn } from '@/lib/utils';\r\nimport { Lock, Shield, Zap, CheckCircle2, Ban } from 'lucide-react'; // <--- Swapped X for Ban\r\n\r\ninterface PredictionTableProps {\r\n  predictions: Prediction[];\r\n  isSubscribed: boolean;\r\n  strategyMode?: 'all' | 'strat_a' | 'strat_b';\r\n}\r\n\r\nexport default function PredictionTable({ \r\n  predictions, \r\n  isSubscribed, \r\n  strategyMode = 'all' \r\n}: PredictionTableProps) {\r\n  \r\n  const showA = strategyMode === 'all' || strategyMode === 'strat_a';\r\n  const showB = strategyMode === 'all' || strategyMode === 'strat_b';\r\n\r\n  const getCellBg = (pick: string, result?: string | null, baseColor?: string) => {\r\n    if (!result) return baseColor;\r\n    return pick === result ? \"bg-green-900/20\" : \"bg-red-900/10\";\r\n  };\r\n\r\n  const renderPredictionCell = (pick: string, result?: string | null, isLocked?: boolean) => {\r\n    if (isLocked) {\r\n      return (\r\n        <div className=\"flex flex-col items-center justify-center h-full relative\">\r\n           <div className=\"blur-md select-none opacity-50 font-bold text-sm\">{pick}</div>\r\n           <div className=\"absolute inset-0 flex items-center justify-center\">\r\n             <Lock className=\"w-4 h-4 text-gray-600\" />\r\n           </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    if (!result) {\r\n      return <div className=\"text-sm font-bold text-white\">{pick}</div>;\r\n    }\r\n\r\n    const isWin = pick === result;\r\n\r\n    return (\r\n      <div className=\"flex items-center justify-center space-x-2\">\r\n        <span className={cn(\"text-sm font-bold\", isWin ? \"text-green-400\" : \"text-red-400 line-through opacity-60\")}>\r\n          {pick}\r\n        </span>\r\n        {isWin ? (\r\n          <CheckCircle2 className=\"w-4 h-4 text-green-500\" />\r\n        ) : (\r\n          /* Using Ban icon (Circle Slash) to avoid confusion with 'X' (Draw) */\r\n          <Ban className=\"w-4 h-4 text-red-500\" />\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"overflow-hidden rounded-xl border border-gray-800 bg-black/40 backdrop-blur-sm\">\r\n      <table className=\"min-w-full divide-y divide-gray-800\">\r\n        <thead className=\"bg-gray-900/50\">\r\n          <tr>\r\n            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Match</th>\r\n            \r\n            {showA && (\r\n              <th className=\"px-6 py-3 text-center text-xs font-medium text-cyan-400 uppercase tracking-wider\">\r\n                <div className=\"flex items-center justify-center space-x-1\">\r\n                  <Shield className=\"w-3 h-3\" /> <span>Strat A</span>\r\n                </div>\r\n              </th>\r\n            )}\r\n            \r\n            {showB && (\r\n              <th className=\"px-6 py-3 text-center text-xs font-medium text-purple-400 uppercase tracking-wider\">\r\n                <div className=\"flex items-center justify-center space-x-1\">\r\n                  <Zap className=\"w-3 h-3\" /> <span>Strat B</span>\r\n                </div>\r\n              </th>\r\n            )}\r\n\r\n            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Result</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody className=\"divide-y divide-gray-800\">\r\n          {predictions.map((pred) => {\r\n            const isLocked = !isSubscribed && !pred.is_free;\r\n\r\n            return (\r\n              <tr key={pred.id} className=\"hover:bg-white/5 transition-colors\">\r\n                <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                  <div className=\"flex flex-col\">\r\n                    <span className=\"text-sm font-bold text-white\">{pred.home_team}</span>\r\n                    <span className=\"text-xs text-gray-500\">vs {pred.away_team}</span>\r\n                    {!pred.result && (\r\n                       <span className=\"text-[10px] text-gray-600 font-mono mt-1\">{pred.match_time}</span>\r\n                    )}\r\n                  </div>\r\n                </td>\r\n\r\n                {showA && (\r\n                  <td className={cn(\"px-6 py-4 whitespace-nowrap text-center relative transition-colors\", getCellBg(pred.strat_a_pick, pred.result, \"bg-cyan-900/5\"))}>\r\n                    {renderPredictionCell(pred.strat_a_pick, pred.result, isLocked)}\r\n                  </td>\r\n                )}\r\n\r\n                {showB && (\r\n                  <td className={cn(\"px-6 py-4 whitespace-nowrap text-center relative transition-colors\", getCellBg(pred.strat_b_pick, pred.result, \"bg-purple-900/5\"))}>\r\n                    {renderPredictionCell(pred.strat_b_pick, pred.result, isLocked)}\r\n                  </td>\r\n                )}\r\n\r\n                <td className=\"px-6 py-4 relative\">\r\n                   {pred.result ? (\r\n                     <div className=\"flex items-center space-x-2\">\r\n                       <span className=\"bg-gray-800 text-white px-3 py-1 rounded text-xs font-bold border border-gray-600 shadow-sm\">\r\n                         {pred.result}\r\n                       </span>\r\n                     </div>\r\n                   ) : (\r\n                     <p className={cn(\"text-xs text-gray-400 max-w-xs\", isLocked && \"blur-sm select-none\")}>\r\n                       {pred.rationale || \"Algorithmic determination based on variance models.\"}\r\n                     </p>\r\n                   )}\r\n                </td>\r\n              </tr>\r\n            );\r\n          })}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 474, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/NEO/jackpot-intel-app/components/ui/Badge.tsx"],"sourcesContent":["import React from 'react'; // <--- ADDED THIS\r\nimport { cn } from \"@/lib/utils\";\r\n\r\ninterface BadgeProps {\r\n  children: React.ReactNode;\r\n  variant?: 'default' | 'outline' | 'destructive' | 'success' | 'warning' | 'neon';\r\n  className?: string;\r\n}\r\n\r\nexport function Badge({ children, variant = 'default', className }: BadgeProps) {\r\n  const variants = {\r\n    default: \"bg-gray-800 text-gray-300\",\r\n    outline: \"border border-gray-700 text-gray-400\",\r\n    destructive: \"bg-red-900/50 text-red-400 border border-red-900\",\r\n    success: \"bg-green-900/50 text-green-400 border border-green-900\",\r\n    warning: \"bg-yellow-900/50 text-yellow-400 border border-yellow-900\",\r\n    neon: \"bg-cyan-900/30 text-cyan-400 border border-cyan-500/50 shadow-[0_0_10px_rgba(34,211,238,0.2)]\",\r\n  };\r\n\r\n  return (\r\n    <span className={cn(\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium\", variants[variant], className)}>\r\n      {children}\r\n    </span>\r\n  );\r\n}"],"names":[],"mappings":";;;;;AACA;;;AAQO,SAAS,MAAM,EAAE,QAAQ,EAAE,UAAU,SAAS,EAAE,SAAS,EAAc;IAC5E,MAAM,WAAW;QACf,SAAS;QACT,SAAS;QACT,aAAa;QACb,SAAS;QACT,SAAS;QACT,MAAM;IACR;IAEA,qBACE,6LAAC;QAAK,WAAW,IAAA,qHAAE,EAAC,2EAA2E,QAAQ,CAAC,QAAQ,EAAE;kBAC/G;;;;;;AAGP;KAfgB"}},
    {"offset": {"line": 510, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/NEO/jackpot-intel-app/app/actions.ts"],"sourcesContent":["'use server';\r\n\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\n// Initialize Supabase Client for Server Actions\r\nconst supabase = createClient(\r\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n);\r\n\r\nexport async function joinCycle(\r\n  cycleId: string, \r\n  userId: string, \r\n  mode: 'full' | 'custom', \r\n  siteName?: string\r\n) {\r\n  \r\n  // 1. Fetch User Profile to check Credits\r\n  const { data: profile } = await supabase\r\n    .from('profiles')\r\n    .select('credits')\r\n    .eq('id', userId)\r\n    .single();\r\n\r\n  const userCredits = profile?.credits || 0;\r\n  const sitesSelected = mode === 'full' ? ['ALL'] : [siteName || 'Unknown'];\r\n  let usedCredit = false;\r\n\r\n  // 2. LOGIC: If they have credits, use one.\r\n  if (userCredits > 0) {\r\n    // Deduct Credit\r\n    const { error: creditError } = await supabase\r\n      .from('profiles')\r\n      .update({ credits: userCredits - 1 })\r\n      .eq('id', userId);\r\n    \r\n    if (creditError) {\r\n      // eslint-disable-next-line no-console\r\n      console.error('Credit Transaction Error:', creditError);\r\n      return { success: false, message: 'Credit transaction failed.' };\r\n    }\r\n    usedCredit = true;\r\n  } \r\n  // Else: Here is where you would normally check for Stripe/MPesa payment success.\r\n  // For MVP, we proceed as \"Pay-as-you-go\" (free for now if no credits).\r\n\r\n  // 3. Insert into Participants table\r\n  const { error } = await supabase\r\n    .from('participants')\r\n    .upsert({\r\n      user_id: userId,\r\n      cycle_id: cycleId,\r\n      sites_selected: sitesSelected,\r\n      checklist_completed: true, // They passed the modal\r\n      personal_outcome: 'pending',\r\n      joined_at: new Date().toISOString()\r\n      // We could add a 'payment_method' column later: 'credit' vs 'cash'\r\n    }, {\r\n      onConflict: 'user_id, cycle_id' // If they already joined, just update their selection\r\n    });\r\n\r\n  if (error) {\r\n    // If insert fails but we deducted credit, we should ideally refund it here.\r\n    // For MVP, logging is sufficient.\r\n    // eslint-disable-next-line no-console\r\n    console.error('Join Cycle Error:', error);\r\n    return { success: false, message: error.message };\r\n  }\r\n\r\n  // 4. Revalidate pages so UI updates immediately\r\n  revalidatePath('/dashboard');\r\n  revalidatePath('/account'); // Update the wallet number on the account page too\r\n  \r\n  return { \r\n    success: true, \r\n    message: usedCredit ? 'Entry Unlocked using 1 Rollover Credit.' : 'Entry Unlocked.' \r\n  };\r\n}\r\n\r\n// --- SETTLEMENT LOGIC (Unchanged) ---\r\n\r\nexport async function settleCycle(cycleId: string, winningPlatform: string | null) {\r\n  // 1. Update Cycle Status\r\n  const newStatus = winningPlatform ? 'success' : 'failed';\r\n  \r\n  const { error: cycleError } = await supabase\r\n    .from('cycles')\r\n    .update({ status: newStatus })\r\n    .eq('id', cycleId);\r\n\r\n  if (cycleError) {\r\n    // eslint-disable-next-line no-console\r\n    console.error('Cycle Status Update Error:', cycleError);\r\n    return { success: false, message: 'Failed to update cycle status' };\r\n  }\r\n\r\n  // 2. Fetch all Participants for this cycle\r\n  const { data: participants } = await supabase\r\n    .from('participants')\r\n    .select('*')\r\n    .eq('cycle_id', cycleId);\r\n\r\n  if (!participants || participants.length === 0) {\r\n    return { success: true, message: 'Cycle closed. No participants found.' };\r\n  }\r\n\r\n  // 3. Loop through and grade each user\r\n  const updates = participants.map(async (user) => {\r\n    let outcome = 'lost';\r\n    let giveCredit = false;\r\n\r\n    // SCENARIO A: The Cycle Failed Globally\r\n    if (!winningPlatform) {\r\n      outcome = 'lost'; \r\n      // Note: For \"Hunter\" cycles, we might not close it here, but let's assume this closes the week.\r\n    } \r\n    // SCENARIO B: The Cycle Won Globally\r\n    else {\r\n      const userSites = user.sites_selected || [];\r\n      const hasFullBundle = userSites.includes('ALL');\r\n      const pickedWinner = userSites.includes(winningPlatform);\r\n\r\n      if (hasFullBundle || pickedWinner) {\r\n        outcome = 'won'; // They rode the bus!\r\n      } else {\r\n        // They picked the wrong site -> ROLLOVER LOGIC\r\n        outcome = 'missed_opportunity';\r\n        giveCredit = true;\r\n      }\r\n    }\r\n\r\n    // Update the participant record\r\n    // If we give credit, we also update the profile credits\r\n    const updates = [];\r\n    \r\n    // Update Participation Record\r\n    updates.push(\r\n      supabase\r\n        .from('participants')\r\n        .update({ \r\n          personal_outcome: outcome,\r\n          rollover_credit: giveCredit \r\n        })\r\n        .eq('id', user.id)\r\n    );\r\n\r\n    // Update Profile Credits (if applicable)\r\n    if (giveCredit) {\r\n       // We need to fetch current credits first to increment safely, or use an RPC.\r\n       // For simplicity in MVP, we do a quick fetch-update or assume an RPC exists.\r\n       // Let's do a safe RPC call if possible, or a direct increment.\r\n       // Since we don't have an 'increment' RPC set up yet, we will fetch-update.\r\n       const { data: p } = await supabase.from('profiles').select('credits').eq('id', user.id).single();\r\n       if (p) {\r\n         updates.push(\r\n           supabase.from('profiles').update({ credits: (p.credits || 0) + 1 }).eq('id', user.id)\r\n         );\r\n       }\r\n    }\r\n\r\n    return Promise.all(updates);\r\n  });\r\n\r\n  await Promise.all(updates);\r\n  revalidatePath('/dashboard');\r\n  revalidatePath('/account');\r\n  return { success: true };\r\n}"],"names":[],"mappings":";;;;;;;MAWsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,6CAAA"}},
    {"offset": {"line": 527, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/NEO/jackpot-intel-app/components/SiteAccordion.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { Event } from '@/types';\r\nimport { ChevronDown, ChevronUp, AlertTriangle, CheckCircle2, Shield, Zap, Package, MousePointer2, Ticket } from 'lucide-react';\r\nimport { cn } from '@/lib/utils';\r\nimport PredictionTable from '@/components/ui/PredictionTable';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { joinCycle } from '@/app/actions';\r\n\r\ninterface SiteAccordionProps {\r\n  events: Event[];\r\n  isSubscribed: boolean;\r\n  cycleId: string;\r\n  userId?: string;\r\n  userCredits?: number; // <--- Received from Dashboard\r\n}\r\n\r\nexport default function SiteAccordion({ events, isSubscribed, cycleId, userId, userCredits = 0 }: SiteAccordionProps) {\r\n  const [openEventId, setOpenEventId] = useState<number | null>(events[0]?.id || null);\r\n  const [hasJoined, setHasJoined] = useState(false);\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {events.map((event) => (\r\n        <AccordionItem \r\n          key={event.id} \r\n          event={event} \r\n          isOpen={openEventId === event.id} \r\n          onToggle={() => setOpenEventId(openEventId === event.id ? null : event.id)}\r\n          isSubscribed={isSubscribed}\r\n          cycleId={cycleId}\r\n          userId={userId}\r\n          hasJoined={hasJoined}\r\n          setHasJoined={setHasJoined}\r\n          userCredits={userCredits} // <--- Pass down\r\n        />\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\n// --- SUB-COMPONENT ---\r\nfunction AccordionItem({ event, isOpen, onToggle, isSubscribed, cycleId, userId, hasJoined, setHasJoined, userCredits }: any) {\r\n  const [activeTab, setActiveTab] = useState<'strat_a' | 'strat_b'>('strat_a');\r\n  const [loading, setLoading] = useState(false);\r\n  const [bundleMode, setBundleMode] = useState<'full' | 'custom'>('full');\r\n\r\n  const handleCommit = async () => {\r\n    if (!userId) return;\r\n    setLoading(true);\r\n\r\n    const result = await joinCycle(cycleId, userId, bundleMode, event.platform);\r\n    \r\n    setLoading(false);\r\n    if (result.success) {\r\n      setHasJoined(true);\r\n      // Optional: Show a toast notification here\r\n    } else {\r\n      alert(\"Error joining cycle: \" + result.message);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"border border-gray-800 rounded-xl bg-gray-900/30 overflow-hidden transition-all\">\r\n      \r\n      {/* HEADER */}\r\n      <button \r\n        onClick={onToggle}\r\n        className=\"w-full flex items-center justify-between p-4 hover:bg-white/5 transition-colors\"\r\n      >\r\n        <div className=\"flex items-center space-x-4\">\r\n          <div className={cn(\"p-2 rounded-lg\", isOpen ? \"bg-cyan-500/20 text-cyan-400\" : \"bg-gray-800 text-gray-400\")}>\r\n            {event.platform === 'SportPesa' ? 'âš½' : 'ðŸŽ¯'}\r\n          </div>\r\n          <div className=\"text-left\">\r\n            <h3 className=\"text-lg font-bold text-white\">{event.platform}</h3>\r\n            <p className=\"text-xs text-gray-400\">{event.event_name} â€¢ Week {event.week_number}</p>\r\n          </div>\r\n        </div>\r\n        <div className=\"flex items-center space-x-3\">\r\n          {(!isSubscribed || !hasJoined) && <Badge variant=\"warning\">LOCKED</Badge>}\r\n          {isOpen ? <ChevronUp className=\"w-5 h-5 text-gray-500\" /> : <ChevronDown className=\"w-5 h-5 text-gray-500\" />}\r\n        </div>\r\n      </button>\r\n\r\n      {/* CONTENT BODY */}\r\n      {isOpen && (\r\n        <div className=\"border-t border-gray-800 p-4 bg-black/20\">\r\n          \r\n          {/* STATE 1: SELECTION (If user hasn't joined yet) */}\r\n          {isSubscribed && !hasJoined ? (\r\n            <div className=\"py-6 space-y-6 max-w-lg mx-auto animate-in fade-in zoom-in-95 duration-300\">\r\n              \r\n              <div className=\"text-center\">\r\n                <h4 className=\"text-xl font-bold text-white mb-2\">Configure Your Entry</h4>\r\n                <p className=\"text-gray-400 text-xs\">Select your risk profile for this cycle.</p>\r\n              </div>\r\n\r\n              {/* BUNDLE SELECTION */}\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <div \r\n                  onClick={() => setBundleMode('full')}\r\n                  className={cn(\r\n                    \"cursor-pointer p-4 rounded-xl border transition-all relative overflow-hidden\",\r\n                    bundleMode === 'full' \r\n                      ? \"bg-cyan-900/20 border-cyan-500\" \r\n                      : \"bg-gray-900 border-gray-800 opacity-60 hover:opacity-100\"\r\n                  )}\r\n                >\r\n                  {bundleMode === 'full' && (\r\n                    <div className=\"absolute top-2 right-2 text-cyan-500\"><CheckCircle2 className=\"w-4 h-4\"/></div>\r\n                  )}\r\n                  <Package className={cn(\"w-8 h-8 mb-3\", bundleMode === 'full' ? \"text-cyan-400\" : \"text-gray-500\")} />\r\n                  <h5 className=\"font-bold text-sm text-white\">Full Bundle</h5>\r\n                  <p className=\"text-[10px] text-gray-400 mt-1\">Recommended. Covers all platforms.</p>\r\n                </div>\r\n\r\n                <div \r\n                  onClick={() => setBundleMode('custom')}\r\n                  className={cn(\r\n                    \"cursor-pointer p-4 rounded-xl border transition-all relative overflow-hidden\",\r\n                    bundleMode === 'custom' \r\n                      ? \"bg-yellow-900/20 border-yellow-500\" \r\n                      : \"bg-gray-900 border-gray-800 opacity-60 hover:opacity-100\"\r\n                  )}\r\n                >\r\n                  {bundleMode === 'custom' && (\r\n                    <div className=\"absolute top-2 right-2 text-yellow-500\"><CheckCircle2 className=\"w-4 h-4\"/></div>\r\n                  )}\r\n                  <MousePointer2 className={cn(\"w-8 h-8 mb-3\", bundleMode === 'custom' ? \"text-yellow-400\" : \"text-gray-500\")} />\r\n                  <h5 className=\"font-bold text-sm text-white\">Single Site</h5>\r\n                  <p className=\"text-[10px] text-gray-400 mt-1\">High Risk. Reduced variance protection.</p>\r\n                </div>\r\n              </div>\r\n\r\n              {/* ACTION BUTTON - DYNAMIC BASED ON CREDITS */}\r\n              <button \r\n                onClick={handleCommit}\r\n                disabled={loading}\r\n                className={cn(\r\n                  \"w-full py-4 font-bold rounded-lg transition-all flex items-center justify-center shadow-lg\",\r\n                  loading \r\n                    ? \"bg-gray-700 cursor-not-allowed\" \r\n                    : userCredits > 0\r\n                      ? \"bg-purple-600 hover:bg-purple-500 text-white shadow-purple-900/20\" // Credit Style\r\n                      : \"bg-cyan-600 hover:bg-cyan-500 text-black shadow-cyan-900/20\" // Normal Style\r\n                )}\r\n              >\r\n                {loading ? 'SYNCING...' : (\r\n                  <div className=\"flex items-center\">\r\n                    {userCredits > 0 ? <Ticket className=\"w-5 h-5 mr-2\" /> : <CheckCircle2 className=\"w-5 h-5 mr-2\" />}\r\n                    <span>\r\n                      {userCredits > 0 \r\n                        ? `REDEEM 1 CREDIT (Balance: ${userCredits})` \r\n                        : `CONFIRM & REVEAL`}\r\n                    </span>\r\n                  </div>\r\n                )}\r\n              </button>\r\n              \r\n              {userCredits === 0 && (\r\n                <p className=\"text-[10px] text-gray-500 text-center uppercase tracking-widest\">\r\n                  Entry Fee: FREE (BETA PHASE)\r\n                </p>\r\n              )}\r\n\r\n            </div>\r\n          ) : (\r\n            \r\n            /* STATE 2: THE REVEAL */\r\n            <div className=\"space-y-4 animate-in fade-in duration-500\">\r\n              <div className=\"flex p-1 bg-gray-800/50 rounded-lg\">\r\n                <button\r\n                  onClick={() => setActiveTab('strat_a')}\r\n                  className={cn(\r\n                    \"flex-1 flex items-center justify-center py-2 text-sm font-bold rounded-md transition-all\",\r\n                    activeTab === 'strat_a' ? \"bg-cyan-900/50 text-cyan-400 shadow-sm\" : \"text-gray-500 hover:text-gray-300\"\r\n                  )}\r\n                >\r\n                  <Shield className=\"w-4 h-4 mr-2\" /> STRATEGY A (SHIELD)\r\n                </button>\r\n                <button\r\n                  onClick={() => setActiveTab('strat_b')}\r\n                  className={cn(\r\n                    \"flex-1 flex items-center justify-center py-2 text-sm font-bold rounded-md transition-all\",\r\n                    activeTab === 'strat_b' ? \"bg-purple-900/50 text-purple-400 shadow-sm\" : \"text-gray-500 hover:text-gray-300\"\r\n                  )}\r\n                >\r\n                  <Zap className=\"w-4 h-4 mr-2\" /> STRATEGY B (SWORD)\r\n                </button>\r\n              </div>\r\n\r\n              <PredictionTable \r\n                predictions={event.predictions || []} \r\n                isSubscribed={isSubscribed && hasJoined}\r\n                strategyMode={activeTab}\r\n              />\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 963, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/NEO/jackpot-intel-app/components/DailyDrops.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { supabase } from '@/lib/supabase';\r\nimport { DailyTip } from '@/types';\r\nimport { Flame, Clock, TrendingUp } from 'lucide-react';\r\nimport { cn } from '@/lib/utils';\r\n\r\nexport default function DailyDrops() {\r\n  const [tips, setTips] = useState<DailyTip[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    async function fetchTips() {\r\n      // Calculate 24 hours ago\r\n      const yesterday = new Date();\r\n      yesterday.setDate(yesterday.getDate() - 1);\r\n\r\n      const { data } = await supabase\r\n        .from('daily_tips')\r\n        .select('*')\r\n        .gt('created_at', yesterday.toISOString()) // Only fresh tips\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (data) setTips(data);\r\n      setLoading(false);\r\n    }\r\n    fetchTips();\r\n  }, []);\r\n\r\n  if (loading) return null; // Don't show anything while loading to avoid layout shift\r\n  if (tips.length === 0) return null; // Hide widget if no active tips\r\n\r\n  return (\r\n    <div className=\"space-y-3 mb-8 animate-in slide-in-from-top-4 duration-700\">\r\n      <div className=\"flex items-center space-x-2 px-1\">\r\n        <Flame className=\"w-5 h-5 text-orange-500 animate-pulse\" />\r\n        <h3 className=\"text-sm font-bold text-orange-500 uppercase tracking-widest\">\r\n          Daily Intel <span className=\"text-gray-600 text-[10px] ml-2 normal-case border border-gray-800 px-2 py-0.5 rounded-full\">Expires in 24h</span>\r\n        </h3>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n        {tips.map((tip) => (\r\n          <div key={tip.id} className=\"bg-gradient-to-br from-gray-900 to-black border border-gray-800 p-4 rounded-xl relative overflow-hidden group hover:border-orange-500/30 transition-all\">\r\n            \r\n            {/* Background Glow */}\r\n            <div className=\"absolute top-0 right-0 w-20 h-20 bg-orange-500/10 blur-3xl rounded-full -mr-10 -mt-10 group-hover:bg-orange-500/20 transition-all\"></div>\r\n\r\n            <div className=\"flex justify-between items-start mb-3\">\r\n              <span className={cn(\r\n                \"text-[10px] font-bold px-2 py-0.5 rounded border uppercase\",\r\n                tip.confidence === 'High' ? \"bg-green-900/20 text-green-400 border-green-900\" :\r\n                tip.confidence === 'Medium' ? \"bg-yellow-900/20 text-yellow-400 border-yellow-900\" :\r\n                \"bg-red-900/20 text-red-400 border-red-900\"\r\n              )}>\r\n                {tip.confidence} Conf.\r\n              </span>\r\n              <span className=\"text-xs font-mono text-gray-500 flex items-center\">\r\n                <Clock className=\"w-3 h-3 mr-1\" />\r\n                {new Date(tip.created_at).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}\r\n              </span>\r\n            </div>\r\n\r\n            <h4 className=\"font-bold text-white text-sm truncate\">{tip.match_name}</h4>\r\n            \r\n            <div className=\"flex items-end justify-between mt-3\">\r\n              <div>\r\n                <p className=\"text-[10px] text-gray-500 uppercase font-bold\">Prediction</p>\r\n                <p className=\"text-lg font-bold text-orange-400\">{tip.tip}</p>\r\n              </div>\r\n              <div className=\"text-right\">\r\n                <p className=\"text-[10px] text-gray-500 uppercase font-bold\">Odds</p>\r\n                <div className=\"flex items-center text-white font-mono font-bold bg-gray-800 px-2 py-1 rounded\">\r\n                  <TrendingUp className=\"w-3 h-3 mr-1 text-gray-400\" />\r\n                  {tip.odds}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AAAA;AAAA;AACA;;;AANA;;;;;AAQe,SAAS;;IACtB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAa,EAAE;IAC/C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,IAAA,0KAAS;gCAAC;YACR,eAAe;gBACb,yBAAyB;gBACzB,MAAM,YAAY,IAAI;gBACtB,UAAU,OAAO,CAAC,UAAU,OAAO,KAAK;gBAExC,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,8HAAQ,CAC5B,IAAI,CAAC,cACL,MAAM,CAAC,KACP,EAAE,CAAC,cAAc,UAAU,WAAW,IAAI,kBAAkB;iBAC5D,KAAK,CAAC,cAAc;oBAAE,WAAW;gBAAM;gBAE1C,IAAI,MAAM,QAAQ;gBAClB,WAAW;YACb;YACA;QACF;+BAAG,EAAE;IAEL,IAAI,SAAS,OAAO,MAAM,0DAA0D;IACpF,IAAI,KAAK,MAAM,KAAK,GAAG,OAAO,MAAM,gCAAgC;IAEpE,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC,gNAAK;wBAAC,WAAU;;;;;;kCACjB,6LAAC;wBAAG,WAAU;;4BAA8D;0CAC9D,6LAAC;gCAAK,WAAU;0CAA6F;;;;;;;;;;;;;;;;;;0BAI7H,6LAAC;gBAAI,WAAU;0BACZ,KAAK,GAAG,CAAC,CAAC,oBACT,6LAAC;wBAAiB,WAAU;;0CAG1B,6LAAC;gCAAI,WAAU;;;;;;0CAEf,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAK,WAAW,IAAA,qHAAE,EACjB,8DACA,IAAI,UAAU,KAAK,SAAS,oDAC5B,IAAI,UAAU,KAAK,WAAW,uDAC9B;;4CAEC,IAAI,UAAU;4CAAC;;;;;;;kDAElB,6LAAC;wCAAK,WAAU;;0DACd,6LAAC,gNAAK;gDAAC,WAAU;;;;;;4CAChB,IAAI,KAAK,IAAI,UAAU,EAAE,kBAAkB,CAAC,EAAE,EAAE;gDAAC,MAAM;gDAAW,QAAO;4CAAS;;;;;;;;;;;;;0CAIvF,6LAAC;gCAAG,WAAU;0CAAyC,IAAI,UAAU;;;;;;0CAErE,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;;0DACC,6LAAC;gDAAE,WAAU;0DAAgD;;;;;;0DAC7D,6LAAC;gDAAE,WAAU;0DAAqC,IAAI,GAAG;;;;;;;;;;;;kDAE3D,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAE,WAAU;0DAAgD;;;;;;0DAC7D,6LAAC;gDAAI,WAAU;;kEACb,6LAAC,mOAAU;wDAAC,WAAU;;;;;;oDACrB,IAAI,IAAI;;;;;;;;;;;;;;;;;;;;uBA/BP,IAAI,EAAE;;;;;;;;;;;;;;;;AAyC1B;GA7EwB;KAAA"}},
    {"offset": {"line": 1196, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/NEO/jackpot-intel-app/app/dashboard/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { supabase } from '@/lib/supabase';\r\nimport { Cycle, Event } from '@/types';\r\nimport StatusCard from '@/components/ui/StatusCard';\r\nimport SiteAccordion from '@/components/SiteAccordion';\r\nimport DailyDrops from '@/components/DailyDrops'; // <--- NEW IMPORT\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Loader2, AlertCircle } from 'lucide-react';\r\nimport Link from 'next/link';\r\n\r\nexport default function Dashboard() {\r\n  const [loading, setLoading] = useState(true);\r\n  const [activeCycle, setActiveCycle] = useState<Cycle | null>(null);\r\n  const [cycleEvents, setCycleEvents] = useState<Event[]>([]);\r\n  const [user, setUser] = useState<any>(null);\r\n  const [credits, setCredits] = useState(0);\r\n\r\n  useEffect(() => {\r\n    async function fetchData() {\r\n      // 1. Get User & Profile\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      \r\n      if (user) {\r\n        setUser(user);\r\n        const { data: profile } = await supabase\r\n          .from('profiles')\r\n          .select('credits')\r\n          .eq('id', user.id)\r\n          .single();\r\n        if (profile) setCredits(profile.credits);\r\n      }\r\n\r\n      // 2. Get Active Cycle\r\n      const { data: cycle } = await supabase\r\n        .from('cycles')\r\n        .select('*')\r\n        .eq('status', 'active')\r\n        .single();\r\n      \r\n      if (cycle) {\r\n        setActiveCycle(cycle);\r\n\r\n        // 3. Get Events AND Predictions\r\n        const { data: events } = await supabase\r\n          .from('events')\r\n          .select('*, predictions(*)')\r\n          .eq('cycle_id', cycle.id)\r\n          .eq('is_active', true)\r\n          .order('id', { ascending: true });\r\n\r\n        if (events) {\r\n           const sortedEvents = events.map((e: any) => ({\r\n             ...e,\r\n             predictions: e.predictions.sort((a: any, b: any) => a.match_id - b.match_id)\r\n           }));\r\n           setCycleEvents(sortedEvents);\r\n        }\r\n      }\r\n      setLoading(false);\r\n    }\r\n\r\n    fetchData();\r\n  }, []);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex h-[50vh] items-center justify-center\">\r\n        <Loader2 className=\"w-8 h-8 animate-spin text-cyan-500\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!activeCycle) {\r\n    return (\r\n      <div className=\"text-center py-20\">\r\n        <h2 className=\"text-2xl font-bold text-gray-500\">No Active Cycles Detected.</h2>\r\n        <p className=\"text-gray-600\">The Hunter Protocol is sleeping. Check back later.</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const earliestDeadline = cycleEvents.length > 0 \r\n    ? cycleEvents.reduce((earliest, current) => {\r\n        return new Date(current.deadline) < new Date(earliest) ? current.deadline : earliest;\r\n      }, cycleEvents[0].deadline)\r\n    : new Date().toISOString();\r\n\r\n  return (\r\n    <div className=\"space-y-8 px-4 pb-20\">\r\n      {/* HEADER SECTION */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-extrabold text-white tracking-tight flex items-center\">\r\n            {activeCycle.name}\r\n            {activeCycle.category === 'Hunter' && (\r\n              <span className=\"ml-3 px-2 py-0.5 rounded text-xs bg-cyan-900/50 text-cyan-400 border border-cyan-700/50\">\r\n                HUNTER PROTOCOL\r\n              </span>\r\n            )}\r\n          </h1>\r\n          <div className=\"flex items-center space-x-3 mt-2 text-sm text-gray-400\">\r\n             <span>Week {activeCycle.current_week}</span>\r\n             <span className=\"text-gray-700\">â€¢</span>\r\n             <span className=\"text-white font-bold\">{activeCycle.target_desc}</span>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"w-full md:w-auto min-w-[300px]\">\r\n          <StatusCard deadline={earliestDeadline} status={activeCycle.status} />\r\n        </div>\r\n      </div>\r\n\r\n      {!user && (\r\n         <div className=\"bg-gradient-to-r from-gray-900 to-black border border-gray-800 p-4 rounded-xl flex items-center justify-between\">\r\n           <div className=\"flex items-center space-x-3\">\r\n             <AlertCircle className=\"text-cyan-500 w-5 h-5\" />\r\n             <div>\r\n               <p className=\"text-sm text-white font-bold\">You are viewing in Guest Mode.</p>\r\n               <p className=\"text-xs text-gray-500\">Data is restricted. Login to unlock the full protocol.</p>\r\n             </div>\r\n           </div>\r\n           <Link href=\"/login\" className=\"text-xs bg-cyan-600 hover:bg-cyan-500 text-black font-bold px-3 py-2 rounded transition-colors\">\r\n             LOGIN\r\n           </Link>\r\n         </div>\r\n      )}\r\n\r\n      {/* DAILY DROPS WIDGET */}\r\n      <DailyDrops />\r\n\r\n      {/* THE MAIN ACCORDION */}\r\n      <div className=\"space-y-2\">\r\n        <div className=\"flex justify-between items-end px-1\">\r\n          <h3 className=\"text-sm font-bold text-gray-500 uppercase tracking-widest\">Target Sites</h3>\r\n          <div className=\"flex items-center space-x-3\">\r\n             {/* Show Credit Balance Badge */}\r\n             {user && (\r\n               <Badge variant=\"neon\" className=\"bg-purple-900/50 border-purple-500/50 text-purple-300\">\r\n                 {credits} Credits Available\r\n               </Badge>\r\n             )}\r\n             <Badge variant=\"outline\">{cycleEvents.length} Active</Badge>\r\n          </div>\r\n        </div>\r\n        \r\n        <SiteAccordion \r\n          events={cycleEvents} \r\n          isSubscribed={!!user} \r\n          cycleId={activeCycle.id}\r\n          userId={user?.id}\r\n          userCredits={credits}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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"}}]
}